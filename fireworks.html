<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>Fireworks - SEQUENTIAL NIGHT SKY</title>
  <style>
    body {
      margin: 0;
      overflow: hidden;
      background: #000000;
    }
    canvas {
      display: block;
    }
  </style>
</head>
<body>
  <canvas id="fireworksCanvas"></canvas>

  <script>
    const canvas = document.getElementById("fireworksCanvas");
    const ctx = canvas.getContext("2d");

    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;

    let particles = [];
    let rockets = [];
    let nextFireworkReady = true;

    
    const explosionTypes = ["burst","ring","willow","palm","spiral","star","double","chaos","heart"];
    let explosionIndex = 0;

    
    const stars = [];
    for (let i = 0; i < 200; i++) {
      stars.push({
        x: Math.random() * canvas.width,
        y: Math.random() * canvas.height,
        r: Math.random() * 1.5,
        alpha: Math.random()
      });
    }

    function drawStars() {
      ctx.fillStyle = "#000000";
      ctx.fillRect(0, 0, canvas.width, canvas.height);
      stars.forEach(star => {
        ctx.beginPath();
        ctx.arc(star.x, star.y, star.r, 0, Math.PI * 2);
        ctx.fillStyle = `rgba(255,255,255,${star.alpha})`;
        ctx.fill();
      });
    }

    class Particle {
      constructor(x, y, vx, vy, color, size, gravity = 0.08) {
        this.x = x;
        this.y = y;
        this.vx = vx;
        this.vy = vy;
        this.color = color;
        this.size = size * 1.5; 
        this.alpha = 1;
        this.decay = Math.random() * 0.015 + 0.015;
        this.gravity = gravity;
        this.friction = 0.98;
        this.trail = [];
        this.maxTrail = 15;
      }

      update() {
        this.trail.push({ x: this.x, y: this.y, alpha: this.alpha });
        if (this.trail.length > this.maxTrail) this.trail.shift();

        this.vy += this.gravity;
        this.vx *= this.friction;
        this.vy *= this.friction;
        this.x += this.vx;
        this.y += this.vy;
        this.alpha -= this.decay;
        this.size *= 0.98;
      }

      draw(ctx) {
        this.trail.forEach((p, i) => {
          const alpha = (i / this.trail.length) * p.alpha * 0.6;
          ctx.fillStyle = this.color.replace("1)", `${alpha})`);
          const s = this.size * (i / this.trail.length) * 0.5;
          ctx.beginPath();
          ctx.arc(p.x, p.y, s, 0, Math.PI * 2);
          ctx.fill();
        });

        ctx.shadowBlur = 20;
        ctx.shadowColor = this.color;
        ctx.fillStyle = this.color.replace("1)", `${this.alpha})`);
        ctx.beginPath();
        ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
        ctx.fill();

        ctx.shadowBlur = 10;
        ctx.fillStyle = `rgba(255,255,255,${this.alpha * 0.8})`;
        ctx.beginPath();
        ctx.arc(this.x, this.y, this.size * 0.4, 0, Math.PI * 2);
        ctx.fill();

        ctx.shadowBlur = 0;
      }
    }

    class Rocket {
      constructor(x, targetY) {
        this.x = x;
        this.y = canvas.height;
        this.targetY = targetY;
        this.vy = -12 - Math.random() * 4;
        this.color = "rgba(255,255,200,1)";
        this.trail = [];
        this.exploded = false;
      }

      update() {
        this.trail.push({ x: this.x, y: this.y });
        if (this.trail.length > 10) this.trail.shift();

        this.y += this.vy;
        this.vy *= 0.98;

        if (!this.exploded && this.y <= this.targetY) {
          this.explode();
          this.exploded = true;
          return true;
        }
        return false;
      }

      draw(ctx) {
        this.trail.forEach((p, i) => {
          const alpha = i / this.trail.length;
          ctx.fillStyle = `rgba(255,255,200,${alpha})`;
          ctx.fillRect(p.x, p.y, 3, 3);
        });

        ctx.fillStyle = this.color;
        ctx.fillRect(this.x - 2, this.y, 4, 8);
      }

      explode() {
        const colors = [
          "rgba(255,50,50,1)",
          "rgba(50,255,50,1)",
          "rgba(50,150,255,1)",
          "rgba(255,200,50,1)",
          "rgba(255,100,255,1)",
          "rgba(100,255,255,1)",
          "rgba(255,255,255,1)"
        ];

       
        const type = explosionTypes[explosionIndex];
        explosionIndex = (explosionIndex + 1) % explosionTypes.length;

        const color = colors[Math.floor(Math.random() * colors.length)];

        if (type === "burst") this.createBurst(color);
        if (type === "ring") this.createRing(color);
        if (type === "willow") this.createWillow(color);
        if (type === "palm") this.createPalm(color);
        if (type === "spiral") this.createSpiral(color);
        if (type === "star") this.createStar(color);
        if (type === "double") this.createDouble(color);
        if (type === "chaos") this.createChaos(color);
        if (type === "heart") this.createHeart(color);
      }

      createBurst(color){const count=120;for(let i=0;i<count;i++){const angle=(Math.PI*2*i)/count;const speed=2+Math.random()*5;particles.push(new Particle(this.x,this.y,Math.cos(angle)*speed,Math.sin(angle)*speed,color,2.5));}}
      createRing(color){for(let i=0;i<60;i++){const angle=(Math.PI*2*i)/60;particles.push(new Particle(this.x,this.y,Math.cos(angle)*5,Math.sin(angle)*5,color,2));}}
      createWillow(color){for(let i=0;i<100;i++){const angle=(Math.PI*2*i)/100;const speed=4+Math.random()*2;particles.push(new Particle(this.x,this.y,Math.cos(angle)*speed,Math.sin(angle)*speed-2,color,2,0.12));}}
      createPalm(color){for(let i=0;i<8;i++){const angle=(Math.PI*2*i)/8;for(let j=0;j<15;j++){const s=2+(j/15)*3;particles.push(new Particle(this.x,this.y,Math.cos(angle)*s,Math.sin(angle)*s,color,2,0.12));}}}
      createSpiral(color){for(let i=0;i<100;i++){const angle=i*0.3;const speed=2+i*0.02;particles.push(new Particle(this.x,this.y,Math.cos(angle)*speed,Math.sin(angle)*speed,color,2));}}
      createStar(color){for(let i=0;i<150;i++){const angle=Math.random()*Math.PI*2;const speed=(i%2===0)?6:3;particles.push(new Particle(this.x,this.y,Math.cos(angle)*speed,Math.sin(angle)*speed,color,2.3));}}
      createDouble(color){for(let layer=1;layer<=2;layer++){const count=80;for(let i=0;i<count;i++){const angle=(Math.PI*2*i)/count;particles.push(new Particle(this.x,this.y,Math.cos(angle)*layer*3,Math.sin(angle)*layer*3,color,2));}}}
      createChaos(color){for(let i=0;i<180;i++){const angle=Math.random()*Math.PI*2;const speed=Math.random()*8;const c=Math.random()>0.5?color:"rgba(255,255,255,1)";particles.push(new Particle(this.x,this.y,Math.cos(angle)*speed,Math.sin(angle)*speed,c,2.2));}}
      createHeart(color){for(let i=0;i<100;i++){let t=Math.random()*Math.PI*2;let x=16*Math.sin(t)**3;let y=-(13*Math.cos(t)-5*Math.cos(2*t)-2*Math.cos(3*t)-Math.cos(4*t));particles.push(new Particle(this.x,this.y,x*0.4,y*0.4,color,2.4));}}
    }

    function tryLaunchNext() {
      if (nextFireworkReady && rockets.length === 0 && particles.length === 0) {
        nextFireworkReady = false;
        const x = canvas.width / 2;
        const targetY = 150 + Math.random() * 200;
        rockets.push(new Rocket(x, targetY));
        setTimeout(() => { nextFireworkReady = true; }, 1400);
      }
    }

    function animate() {
      drawStars();

      tryLaunchNext();

      for (let i = rockets.length - 1; i >= 0; i--) {
        rockets[i].draw(ctx);
        if (rockets[i].update()) rockets.splice(i, 1);
      }

      for (let i = particles.length - 1; i >= 0; i--) {
        particles[i].update();
        particles[i].draw(ctx);
        if (particles[i].alpha <= 0) particles.splice(i, 1);
      }

      requestAnimationFrame(animate);
    }

    animate();

    window.addEventListener("resize", () => {
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;
    });
  </script>
</body>
</html>
